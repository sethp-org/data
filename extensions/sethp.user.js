// ==UserScript==
// @name SetHP Script
// @description Скрипт для удобной работы с логами
// @version 0.0.21
// @homepage https://sethp.xyz
// @match https://arizonarp.logsparser.info/*
// @match https://forum.arizona-rp.com/*
// @connect github.com
// @connect githubusercontent.com
// @connect sethp.xyz
// @downloadURL https://github.com/sethp-org/data/raw/main/extensions/sethp.user.js
// @grant unsafeWindow
// @grant GM_info
// @grant GM_download
// @grant GM_getValue
// @grant GM_setValue
// @grant GM_listValues
// @grant GM_deleteValue
// @grant GM_xmlhttpRequest
// @grant GM_registerMenuCommand
// @grant GM_addValueChangeListener
// @grant GM_removeValueChangeListener
// @grant GM_notification
// @grant GM_openInTab
// @icon https://www.google.com/s2/favicons?sz=64&domain=logsparser.info
// @namespace sethp
// @run-at document-end
// @updateURL https://github.com/sethp-org/data/raw/main/extensions/sethp.meta.js
// ==/UserScript==

(()=>{"use strict";var e={615:(e,t,n)=>{function i(){return document.getElementsByClassName("table table-hover")[0]}function l(){return i().querySelector("thead").children[0]}function o(){return i().querySelector("tbody")}function s(){return document.querySelector("#app > div.app-content.app-content--sidebar > div > div > div > div > div > form")}function r(){return document.querySelector("#navbarSupportedContent > ul.navbar-nav.ms-auto")}function a(){return document.querySelector("#app > div.app-content.app-content--sidebar > div")}function c(){return document.querySelector("#top > div.p-body > div > ul:nth-child(1)")}function d(){return document.querySelector("#app > div.app-content.app-content--sidebar > div > div.row > div > div > div > div.row.mb-3.js_toolbar.app-content-entry__toolbar")}function u(){return document.querySelector("#app > div.app-content.app-content--sidebar > div > div > div > div > div > form > div.col-sm-12.mt-3.mb-2.filter-buttons")}function p(){return document.querySelector("#app > div.app-content.app-content--sidebar > div > div.row > div > div > div > div.row.mb-3.js_toolbar.app-content-entry__toolbar > div:nth-child(2) > div > div > div.col-sm-4 > select")}n.r(t),n.d(t,{ContentBody:()=>a,DivGreenButtons:()=>u,FormResearch:()=>s,ForumBreadCrumbs:()=>c,NavBar:()=>r,SelectLimitRows:()=>p,Table:()=>i,TableBody:()=>o,TableHead:()=>l,ToolBar:()=>d})}},t={};function n(i){var l=t[i];if(void 0!==l)return l.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{function e(){return GM_getValue("settings.duplicate","hidden-duplicate")}function t(){return GM_getValue("settings.duplicate.color","#D1D1D1")}function i(){return GM_getValue("settings.botauth","highlight")}function l(){return GM_getValue("settings.hiddenbalance","false")}function o(){return GM_getValue("settings.hiddenip","true")}function s(){return GM_getValue("settings.showregip","none")}function r(e){return GM_setValue("settings.filterlogtext",e)}function a(){return GM_getValue("settings.filterlogs","show")}function c(e){return GM_setValue("settings.filterlogs.options",e)}function d(){return GM_getValue("settings.filterlogs.options","show")}function u(){return GM_getValue("settings.convert.euro",0)}function p(){return GM_getValue("logs",[])}function h(e){return GM_setValue("logs",e)}var m=n(615);function f(e){return new Promise(((t,n)=>{GM_xmlhttpRequest({method:"GET",url:e,onload:function(e){t(e)}})}))}function b(e){return e*Math.PI/180}class g{constructor(e,t,n,i,l,o,s,r){this.ip=e,this.country=t,this.city=n,this.mobile=i,this.proxy=l,this.hosting=o,this.lat=s,this.lon=r}toString(){return`(Страна: ${this.country} Город: ${this.city} Mobile: ${this.mobile?"+":"-"} Proxy: ${this.proxy?"+":"-"} Host: ${this.hosting?"+":"-"})`}distanceTo(e){return(t=this.lat,n=this.lon,i=e.lat,l=e.lon,o=b(i-t),s=b(l-n),r=Math.sin(o/2)*Math.sin(o/2)+Math.cos(b(t))*Math.cos(b(i))*Math.sin(s/2)*Math.sin(s/2),2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))*6371.21).toFixed(2);}}function v(e,t){return new Promise(((n,i)=>{f(t?`https://ip-api.com/ip/${e}`:`https://ip-balancer.sethp.xyz/ip/${e}`).then((t=>{const i=JSON.parse(t.responseText);n(new g(e,i.country,i.city,i.mobile,i.proxy,i.hosting,i.lat,i.lon))})).catch((e=>{reject(e)}))}))}const y="255.255.255.255";function x(){return document.querySelector("#app > div.app-content.app-content--sidebar > div > div > div > div > div > form > div.js_component_filter_item_player.col-sm-3.mb-2 > input").value}var T=/время сессии: (.*),/;function M(e){const t=e.split(":");return 3600*parseInt(t[0])+60*parseInt(t[1])+parseInt(t[2])}const w=/\[id: (\d*)\] \(цвет: \#(\w{6}), идентификатор: (.*), заточка: (.*), прочность: (.*), окончание: (.*)\) в количестве/;function L(e){switch(e){case"FFFFFF":return"белый";case"000000":return"черный";case"FF0000":return"красный";case"00FF00":return"зеленый";case"0000FF":return"синий";case"FF8000":return"темно-оранжевый";case"FFFF00":return"желтый";case"FFBF00":return"оранжевый";case"00FFFF":return"голубой";case"FF00FF":return"розовый";case"FF0077":return"малиновый"}}function _(e){switch(e){case"3":return"защита";case"6":return"реген";case"9":return"урон";case"12":return"удача";case"15":return"плюс хп";default:return"неизвестно"}}function $(){const e=(0,m.TableBody)(),t=document.getElementById("sethp-filter-logs").value.split("\n");for(let t=0;t<e.children.length;t++)e.children[t].style.cssText="display: table-row";const n=d();console.log(n);for(let i=0;i<e.children.length;i++){const l=e.children[i];let o=!1;for(let e=0;e<t.length;e++)if(-1!==l.children[1].innerText.indexOf(t[e])){o=!0;break}"show"===n&&(o||(l.style.cssText="display: none")),"hide"===n&&o&&(l.style.cssText="display: none")}}function k(e){(0,m.TableHead)().children[3].style.display=e?"none":"table-cell";const t=(0,m.TableBody)();for(let n=0;n<t.children.length;n++)t.children[n]&&t.children[n].children[3]&&(t.children[n].children[3].style.display=e?"none":"table-cell")}function B(e){(0,m.TableHead)().children[2].style.display=e?"none":"table-cell";const t=(0,m.TableBody)();for(let n=0;n<t.children.length;n++)t.children[n]&&t.children[n].children[2]&&(t.children[n].children[2].style.display=e?"none":"table-cell")}const{ToolBar:H}=n(615);function E(e,t){let n="?info=1";for(let e in t)n+=`&${e}=${t[e]}`;return`${e.origin}${e.pathname}`+n}function S(e,t,n,i){var l=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=n.length,l=0;l<10;l++)t+=n.charAt(Math.floor(Math.random()*i));return t}();const o=document.createElement("div");o.id=l;let s="inputelementname"+l;for(let e=0;e<t.length;e++){let i=t[e];o.innerHTML+=`\n        <div class="form-check" radio-value="${i.value}">\n          <input class="form-check-input" type="radio" name="${s}" id="${s+e}" ${n===i.value?"checked":""} radio-value="${i.value}" identify-id="${l}">\n          <label class="form-check-label" for="${s+e}" radio-value="${i.value}" identify-id="${l}">\n            ${i.text}\n          </label>\n        </div>\n        `}return e.appendChild(o),l}switch(document.querySelector("#app > div.app-content.app-content--sidebar > div > div > div > div > div > form"),window.location.hostname){case"arizonarp.logsparser.info":console.log("[SetHP Extensions] Logs mode"),(0,m.NavBar)().innerHTML+='\n<li class="nav-item" id="sethp-settings-modal-show">\n    <a id="" class="nav-link text-primary" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" v-pre="">\n       <i class="bi bi-gear-fill"></i>\n    </a>\n</li>\n    ',document.getElementById("sethp-settings-modal-show").addEventListener("click",(()=>{document.getElementById("sethp-modal-settings").style.display="block"})),function(){const n=(0,m.ContentBody)();n.innerHTML='\n    <div class="modal" tabindex="-1" id="sethp-modal-settings" style="display: none" role="dialog" aria-hidden="true">\n    <div class="modal-dialog" role="document">\n      <div class="modal-content">\n        <div class="modal-header">\n          <h5 class="modal-title">Настройка SetHP Scripts</h5>\n          <button type="button" class="btn-close" data-bs-dismiss="modal" id="sethp-button-close-1" aria-label="Close"></button>\n        </div>\n        <div class="modal-body" id="modal-settings-body">\n          \n        </div>\n        <div class="modal-footer">\n          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="sethp-button-close-2">Закрыть</button>\n        </div>\n      </div>\n    </div>\n  </div>\n    '+n.innerHTML;const r=function(){document.getElementById("sethp-modal-settings").style.display="none"},c=document.getElementById("sethp-button-close-1"),d=document.getElementById("sethp-button-close-2");c.addEventListener("click",r),d.addEventListener("click",r);const p=document.getElementById("modal-settings-body"),h=document.createElement("div");h.innerHTML+="<h5>Дублирующие строки</h5>";let f=S(h,[{text:"Ничего",value:"none"},{text:"Скрывать дублирующие",value:"hidden-duplicate"},{text:"Помечать другим цветом",value:"show-gray"}],e());h.innerHTML+=`\n    <div class="input-group mb-3">\n    <label class="mb-1 mt-2 text-muted">Код цвета</label>\n    <input type="text" id="sethp-input-duplicate-color" class="form-control" placeholder="Цвет" value="${t()}" maxlength="7"/>\n    </div>\n    `,h.innerHTML+="<h5>Вход ботов на аккаунт</h5>";let b=S(h,[{text:"Ничего",value:"none"},{text:"Выделять",value:"highlight"}],i());h.innerHTML+="<h5>Скрывать колонку с балансом</h5>";let g=S(h,[{text:"Скрывать",value:"true"},{text:"Отображать",value:"false"}],l());h.innerHTML+="<h5>Скрывать колонку с IP</h5>";let v=S(h,[{text:"Скрывать",value:"true"},{text:"Отображать",value:"false"}],o());h.innerHTML+="<h5>Отображать рег ип на строчке с авторизацией</h5>";let y=S(h,[{text:"Скрывать",value:"none"},{text:"Отображать",value:"show"}],s());h.innerHTML+="<h5>Поле с фильтром</h5>";let x=S(h,[{text:"Скрывать",value:"none"},{text:"Отображать",value:"show"}],a());h.innerHTML+="<h5>Конвертация ЕВРО</h5>",h.innerHTML+=`\n    <div class="input-group mb-3">\n    <input type="text" id="sethp-input-euro-value" class="form-control" placeholder="Курс Евро" value="${u()}" maxlength="15"/>\n    </div>\n    `,p.appendChild(h);const T={};T[f]=e=>{!function(e){GM_setValue("settings.duplicate",e)}(e)},T[b]=e=>{!function(e){GM_setValue("settings.botauth",e)}(e)},T[g]=e=>{!function(e){GM_setValue("settings.hiddenbalance",e)}(e),B("true"===e)},T[y]=e=>{!function(e){GM_setValue("settings.showregip",e)}(e)},T[x]=e=>{!function(e){GM_setValue("settings.filterlogs",e)}(e)},T[v]=e=>{!function(e){GM_setValue("settings.hiddenip",e)}(e),k("true"===e)},h.addEventListener("click",(e=>{if(e.target){const t=e.target.getAttribute("identify-id"),n=e.target.getAttribute("radio-value"),i=T[t];i&&i(n)}})),h.addEventListener("input",(e=>{switch(e.target.id){case"sethp-input-duplicate-color":t=e.target.value,GM_setValue("settings.duplicate.color",t);break;case"sethp-input-euro-value":!function(e){GM_setValue("settings.convert.euro",e)}(parseInt(e.target.value))}var t})),h.innerHTML+="\n    <br><p><small>Многие изменения появляются после обновления страницы<br>Есть вопросы? Всегда готов пообщаться: set#6517 или vk.com/id326575957</small><p>\n    "}(),(0,m.FormResearch)().children[1].insertAdjacentHTML("afterend",'<div id="calendar-period" class="col-sm-3 mb-2">\n        <label class="mb-1 mt-2 text-muted">Указать конкретный день</label>\n        <input name="date" type="date" class="form-control " value="" placeholder="">\n    </div>'),document.getElementById("calendar-period").addEventListener("change",(e=>{const t=document.querySelector("#app > div.app-content.app-content--sidebar > div > div > div > div > div > form > div.js_component_filter_item_min_period.col-sm-3.mb-2 > div > input"),n=document.querySelector("#app > div.app-content.app-content--sidebar > div > div > div > div > div > form > div.js_component_filter_item_max_period.col-sm-3.mb-2 > div > input");t.value=e.target.value+" 00:00:00",n.value=e.target.value+" 23:59:59"})),function(){const e=[];new g;let t="";const n=(0,m.TableBody)(),i=[],l={},o="sethp-data-log-ip-info",r=/(\w*).(\d*) ЕВРО/,a=u();for(let s=0;s<n.children.length;s++){const c=n.children[s].children[1].innerText,d=n.children[s];if(-1!==c.indexOf("авторизовался на сервер")||-1!==c.indexOf("вышел с сервера")){const n=d.querySelector("tr > td:nth-child(4) > div").children,s=n[1].innerText;s!==y&&(l[s]=!0,d.children[1].innerHTML+=`IP: <b><a style="color: #495057" href="${n[1].href}">${s}</a></b>`,d.setAttribute("ip",s),d.classList.add(o),i.push(d)),n[2].innerText!==y&&(t=n[2].innerText,l[n[2].innerText]=!0),-1!==c.indexOf("время сессии: 00:00:00")&&(e.push(d),d.style.cssText="display: none")}if(a>0&&-1!==c.indexOf("ЕВРО")){const e=c.match(r),t=parseInt(e[2]);d.children[1].innerHTML=c.substring(0,e.index)+`${e[1]} ${t} ЕВРО ($${t*a})`+c.substring(e.index+e[0].length)}}const c=[];for(const e in l){const t=new Promise(((t,n)=>{v(e).then((e=>{t(e)})).catch((n=>{console.warn("[SetHP Extensions] Get ip from original",e),v(e,!0).then((e=>{t(e)})).catch((n=>{t(new g(e,"Ошибка получения данных","","","",""))}))}))}));c.push(t)}const d=s();Promise.all(c).then((e=>{for(let t=0;t<e.length;t++)l[e[t].ip]=e[t];const n=x();for(const e of document.getElementsByClassName(o)){const i=e.getAttribute("ip"),o=l[i];e.children[1].innerHTML+="&nbsp;"+o,n&&t&&(e.children[1].innerHTML+=" ~"+o.distanceTo(l[t])+"km",d&&(e.children[1].innerHTML+="&nbsp;Reg IP: "+t))}})).catch((e=>{console.error(e)}));let p={};for(let t=0;t<e.length;t++){const n=e[t].children[1].innerText.match(/Игрок (.*) вышел с сервера/)[1];p[n]?p[n]++:p[n]=1}if(p=Object.entries(p).sort(((e,t)=>t[1]-e[1])),p.filter((e=>e[1]>1)).length>0){let e="<tr><td></td><td><b>Выходы без авторизации больше 1 раза</b></td><td></td></tr>";for(let t of p)t[1]<2||(e+=`<tr><td></td><td>Игрок ${t[0]} вышел с сервера ${t[1]} раз(-а)</td><td></td></tr>`);(0,m.TableBody)().innerHTML+=e}GM_setValue("regip",null)}(),function(){if(x()){let e=null;const t=(0,m.TableBody)();for(let n=0;n<t.children.length;n++){if(!t.children[n].children[3])continue;const i=t.children[n].children[3].children;if(1===i.length&&-1===i[0].innerText.indexOf("255.255.255.255")){e=i[0].querySelector("div > a:nth-child(3)");break}}if(null!==e){const t=(0,m.DivGreenButtons)();t.innerHTML+=`<span>Рег IP: <a href="${e.href}" target="_blank">${e.innerText}</a> `,v(e.innerText).then((e=>{t.innerHTML+=e})).finally((()=>{t.innerHTML+="</span>"}))}}}(),function(){let n="",i=0,l=-1;const o=(0,m.TableBody)(),s=e();if("none"!==s)for(let e=0;e<o.children.length;e++){const r=o.children[e].children[1].innerText;n!==r?(i>1&&"hidden-duplicate"===s&&(o.children[l].children[1].innerHTML+=` <b>(Скрыто ${i-1} строчек)</b>`),n=r,i=0,l=e):i>0&&("hidden-duplicate"===s?o.children[e].style.cssText="display: none":"show-gray"===s&&(o.children[e].style.cssText="background: "+t())),i++}}(),function(){const e=(0,m.TableBody)();if("none"===i())return;let t=null;for(let n=e.children.length-1;n>=0;n--){const i=e.children[n],l=i.children[1].innerText;if(-1!==l.indexOf("авторизовался на сервер"))t=i.children[1];else if(-1!==l.indexOf("вышел с сервера")){if(null===t)continue;let e=l.match(T);if(null===e)continue;e=e[1],M(e)<=60&&(i.children[1].style.cssText="color: red",t.style.cssText="color: red"),t=null}else t=null}}(),function(){const e=(0,m.TableBody)();for(let t=0;t<e.children.length;t++){const n=e.children[t],i=n.children[1].innerHTML;if(-1!==i.indexOf("цвет: #")){const e=i.match(w);if(null===e)continue;let t="<label> "+n.children[1].innerHTML.substring(0,e.index);t+=`[id: </label><label style="cursor: pointer" onclick="window.open('https://items.shinoa.tech/images/model/${e[1]}.png', '_blank')">${e[1]}] </label> </label>`,t+=`(цвет: #${e[2]} </label>`,t+=`<label style="color: #${e[2]}; text-shadow: 1px 1px 1px #000;">&nbsp;(${L(e[2])})&nbsp;</label>`;const l="03:00 01.01.1970"===e[6]?"-":e[6];t+=`<label>, идентификатор: ${e[3]} (${_(e[3])}), заточка: ${e[4]}, прочность: ${e[5]}, окончание: ${l}) в количестве&nbsp;</label>`,t+="<label> "+n.children[1].innerHTML.substring(e.index+e[0].length)+" </label>",n.children[1].innerHTML=t}}}(),(0,m.DivGreenButtons)().addEventListener("click",(e=>{"sethp-logs-forms"===e.target.id&&function(){const e=prompt("\nСоздание формы. С помощью данного меню вы можете создать форму на общую команду. Из строчек, которые указаны ниже, будет создана форма. Под форму попадают все пользователи, строчки в логах которые начинаются на Игрок Name\nНапример, данный шаблон создаст команды на бан:\n/banoff 0 {user} 2000 махинации\n\nСкрипт будет собирать только те строчки, которые отображены у вас. Если вы воспользовались фильтром на скрытие каких-то строчек, то их не будет в форме.\n\nВ поле ниже вам необходимо указать шаблон, под который будут сгенерированы команды\n    ",GM_getValue("settings.logs.form",""));if(!e)return;GM_setValue("settings.logs.form",e);const t=/^Игрок (\w*)/,n=e.substring(0,e.indexOf("{user}")),i=e.substring(e.indexOf("{user}")+"{user}".length);let l="",o={};const s=(0,m.TableBody)();for(let e=0;e<s.children.length;e++){const n=s.children[e];if("display: none"===n.style.cssText)continue;const i=n.children[1].innerText.match(t);null!==i&&(o[i[1]]=!0)}for(let e in o)l+=`${n}${e}${i}\n`;navigator.clipboard.writeText(l),alert("Следующие строчки скопированы в буфер обмена:\n\n"+l)}()})),document.head.innerHTML+='\n        <style id="hui">\n        .app-sidebar.bg-dark\n        {\n        visibility: hidden\n        }\n        .app-content--sidebar {\n        margin-left: 0px\n        }\n        .app-nav .navbar-brand {\n        position: inherit;\n        background: none;\n        }\n        </style>\n    ',k("true"===o()),"show"===a()&&function(){H().innerHTML+=`\n<div class="pt-4 col-sm-3">\n    <textarea class="form-control" id="sethp-filter-logs" rows="3" style="height: 72px;" placeholder="Фильтр для логов. Перечисляйте каждый фильтр на новой строке. Нажимая применять, загруженные ниже логи будут обработаны данным фильтром"></textarea>\n</div>\n<div class="col-sm-3 pt-4">\n    <button type="submit" id="sethp-filter-logs-submit" class="btn btn-success">Применить</button>\n    <button type="submit" id="sethp-filter-logs-submit-reset" class="btn btn-success-reset"><i class="bi bi-arrow-clockwise"></i></button>\n    <div id="sethp-filter-logs-options">\n        <div class="form-check">\n            <input class="form-check-input" type="radio" name="sethp-filter-logs-options" id="sethp-filter-logs-options-1" ${"show"===d()?"checked":""}>\n            <label class="form-check-label" name="sethp-filter-logs-options" for="sethp-filter-logs-options-1">Оставить</label>\n        </div>\n        <div class="form-check">\n            <input class="form-check-input" name="sethp-filter-logs-options" type="radio" value="" id="sethp-filter-logs-options-2" ${"hide"===d()?"checked":""}>\n            <label class="form-check-label" name="sethp-filter-logs-options" for="sethp-filter-logs-options-2">Скрыть</label>\n        </div>\n    </div>\n</div>\n\n    `;let e=document.getElementById("sethp-filter-logs");e.value=GM_getValue("settings.filterlogtext",""),e.addEventListener("input",(e=>{r(e.target.value)})),document.getElementById("sethp-filter-logs-submit").addEventListener("click",(()=>{$()})),document.getElementById("sethp-filter-logs-submit-reset").addEventListener("click",(()=>{e.value="",r(""),$()})),document.getElementById("sethp-filter-logs-options").addEventListener("click",(e=>{switch(e.target.id){case"sethp-filter-logs-options-1":c("show");break;case"sethp-filter-logs-options-2":c("hide")}}))}(),function(){const e=(0,m.DivGreenButtons)(),t=document.createElement("button");t.type="button",t.id="sethp-logs-forms",t.classList.add("btn"),t.classList.add("btn-success");const n=document.createElement("i");n.classList.add("bi"),n.classList.add("bi-card-text"),t.appendChild(n),t.innerText+=" Формы",e.insertBefore(t,e.children[1])}(),function(){const e=[2e3,5e3,1e4];for(let t of e){let e=document.createElement("option");e.id=`sethp-select2-limit-b4-results-${t}`,e.value=t,e.innerText=t,e.setAttribute("sethp-limit",t),(0,m.SelectLimitRows)().appendChild(e)}let t=new URL(window.location.href),n=Object.fromEntries(t.searchParams.entries());if(parseInt(n.limit)>1e3)alert("Начинается загрузка логов с установленным лимитом в "+n.limit+" строк. Пожалуйста, никуда не нажимаете и не открывайте новую вкладку. Вас оповещат, когда все строчки будут загружены. Если логи перестают работать - крепитесь. Тут я вам не помогу. Лучше заново начать загружать, чтобы не было дубликатов"),n["sethp-load-limit"]=1,n["sethp-max-pages"]=Math.ceil(n.limit/1e3),n.page=1,h([]),n.limit=1e3,window.location.href=E(t,n);else if(n["sethp-load-limit"]){let e=parseInt(n.page)||1;const i=parseInt(n["sethp-max-pages"]),l=p();if(l.push((0,m.TableBody)().innerHTML),h(l),e<i)e++,n.page=e,window.location.href=E(t,n);else{delete n["sethp-load-limit"];const e=p();(0,m.TableBody)().innerHTML=e.join(""),h([]),alert("Логи загружены. Можете продолжить работу")}}}(),function(){(0,m.TableHead)().children[1].style.cssText="width: 65%";let e=document.createElement("style");document.head.appendChild(e),e.innerHTML="\n.select2-results__option--selectable {\n    ::-moz-selection {\n        background: transparent;\n    }\n    \n    ::selection {\n        background: transparent;\n    }\n}\n    ";for(let e of document.getElementsByClassName("select2-results__option select2-results__option--selectable"))e.classList.add("fix-search-elements");if(document.getElementById("styleForumScript")){let e=document.createElement("style");document.head.appendChild(e),e.innerHTML='\n        .form-control[type="date"]::-webkit-calendar-picker-indicator {\n            filter: invert(1);\n        }\n        ';let t=document.getElementById("sethp-filter-logs-submit-reset");t&&(t.style.cssText="filter: invert(1)")}}(),function(){const e=document.querySelector("#navbarDropdown").innerText,t=document.querySelector("#navbarSupportedContent > ul.navbar-nav.ms-auto > li.nav-item.d-flex.align-items-center.me-2 > span").innerText,n=GM_info.script.version;GM_xmlhttpRequest({method:"GET",url:"https://api.sethp.xyz/anal?nickname="+e+"&server="+t+"&version="+n})}(),"true"===l()&&B(!0),new Promise(((e,t)=>{f("https://github.com/sethp-org/data/raw/main/extensions/script.json").then((t=>{const n=JSON.parse(t.response);e(n.version)}))})).then((e=>{if("0.0.21"!==e)try{console.log("[Script Extensions] Доступно обновление "+e),function(){const e=(0,m.ContentBody)();e.innerHTML='\n    <div class="modal" tabindex="-1" id="sethp-modal-alerts" style="display: none">\n    <div class="modal-dialog modal-dialog-scrollable">\n      <div class="modal-content">\n        <div class="modal-header">\n          <h5 class="modal-title">Доступно новое обновление</h5>\n        </div>\n        <div class="modal-body" id="modal-alerts-body">\n          \n        </div>\n        <div class="modal-footer">\n            <p>Это обновление является обязательным. Нажмите кнопку ниже, чтобы обновить скрипт</p>\n          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" id="sethp-alerts-button-update">Обновить скрипт</button>\n        </div>\n      </div>\n    </div>\n  </div>\n    '+e.innerHTML;let t=document.getElementById("sethp-alerts-button-update");t.addEventListener("click",(()=>{GM_openInTab("https://github.com/sethp-org/data/raw/main/extensions/sethp.user.js"),t.innerText="Можете обновить страницу"}));const n=document.getElementById("modal-alerts-body");f("https://github.com/sethp-org/data/raw/main/extensions/script.json").then((e=>{let t=JSON.parse(e.response).alerts;for(let e of Object.keys(t)){let i=t[e];n.innerHTML+=`\n            <h5>${i.title}</h5>\n            <p>${i.description}</p>\n            `}}))}(),document.getElementById("sethp-modal-alerts").style.display="block"}catch(e){return document.body.innerHTML='Обновите скрипт в tampermonkey. Просто перейдите по ссылке ниже: <a href="https://github.com/sethp-org/data/raw/main/extensions/sethp.user.js">https://github.com/sethp-org/data/raw/main/extensions/sethp.user.js</a>',!1}}));break;case"forum.arizona-rp.com":console.log("[SetHP Extensions] Forum mode"),function(){const e=/http:\/\/ulog\.union-u\.net\/search\.php\?searchtext=(\w*)\&server=(\d*)/,t=document.getElementsByClassName("bbCodeBlock bbCodeBlock--hide bbCodeBlock--visible");for(let i of t){if(i.children.length<2)continue;const t=i.children[1].innerText;if(-1===t.indexOf("http://ulog.union-u.net/"))continue;const l=e.exec(t);if(l){console.log(l[1],l[2]);const e=`https://arizonarp.logsparser.info/?server_number=${n=parseInt(l[2]),{1:1,2:2,3:3,4:4,5:5,8:6,9:7,10:8,12:9,15:10,19:11,20:12,21:13,22:14,23:15,24:16,25:17,26:18,27:19,28:20,30:21,32:22,34:23,35:24,29:101,31:102,33:103}[n]||0}&sort=desc&player=${l[1]}&limit=1000`;console.log(e),i.children[1].innerHTML=`<a href="${e}" target="_blank" class="link link--external" rel="nofollow noopener">${e}</a>`}}var n}(),function(){const e=document.getElementsByClassName("bbCodeBlock bbCodeBlock--hide bbCodeBlock--visible");for(let t of e){if(t.children.length<2)continue;let e=t.children[1].innerText+"&limit=1000";-1!==e.indexOf("https://arizonarp.logsparser.info")&&(t.children[1].innerHTML=`<a href="${e}" target="_blank" class="link link--external" rel="nofollow noopener">${e}</a>`)}}()}console.log(`[SetHP Extensions] Loaded! Version: 0.0.21 Date build: ${{}}`)})()})();